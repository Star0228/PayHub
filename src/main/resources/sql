create database payhub;
use payhub;
-- CREATE TABLE users (
--                        id INT AUTO_INCREMENT PRIMARY KEY,
--                        username VARCHAR(50) UNIQUE NOT NULL,
--                        password VARCHAR(255) NOT NULL,
--                        email VARCHAR(100) UNIQUE NOT NULL
-- );


CREATE TABLE account (
    id BIGINT PRIMARY KEY,
    account_id BIGINT,
    password VARCHAR(255),
    card_id BIGINT,
    username VARCHAR(255),
    email VARCHAR(100) UNIQUE NOT NULL,
    address VARCHAR(255),
    gender VARCHAR(64),
    occupation VARCHAR(255),
    phone_number BIGINT,
    annual_income DECIMAL(15,2)
);

-- 账户余额表
CREATE TABLE account_balance (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    account_id BIGINT NOT NULL,
    balance DECIMAL(15,2) NOT NULL DEFAULT 0.00,
    currency VARCHAR(10) NOT NULL DEFAULT 'CNY',
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE KEY (account_id, currency)
);

-- 交易记录表
CREATE TABLE transaction_record (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    transaction_id VARCHAR(64) NOT NULL UNIQUE,
    from_account_id BIGINT NOT NULL,
    to_account_id BIGINT NOT NULL,
    amount DECIMAL(15,2) NOT NULL,
    currency VARCHAR(10) NOT NULL DEFAULT 'CNY',
    status VARCHAR(20) NOT NULL DEFAULT 'PENDING', -- PENDING, SUCCESS, FAILED
    type VARCHAR(20) NOT NULL, -- TRANSFER, DEPOSIT, WITHDRAWAL 
    description VARCHAR(255),
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    completed_at TIMESTAMP,
);
